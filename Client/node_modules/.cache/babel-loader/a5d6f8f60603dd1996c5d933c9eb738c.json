{"ast":null,"code":"var _jsxFileName = \"/home/quoctai/Tai/LSH (copy)/Client/src/component/backupDatabase.js\";\nimport React, { Component } from 'react';\nimport Dropzone from 'react-dropzone';\nimport axios from 'axios';\nimport './backupDatabase.css';\n\nconst Papa = require('papaparse');\n\nvar FileSaver = require('file-saver');\n\nconst readText = file => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.readAsText(file);\n\n  reader.onload = () => resolve(reader.result);\n\n  reader.onerror = reject;\n});\n\nclass BackupDatabase extends Component {\n  constructor(props) {\n    super(props);\n\n    this.exPort = () => {\n      let link = 'http://localhost:8000/getAllDatabase';\n      axios.post(link).then(result => {\n        this.setState({\n          lisAutoMarker: result.data.listAutoMarker\n        });\n        this.setState({\n          lisSeat: result.data.listSeat\n        });\n        this.setState({\n          listBus: result.data.listBus\n        });\n        let lisAutoMarkerCsv = Papa.unparse(this.state.lisAutoMarker);\n        let lisBusCsv = Papa.unparse(this.state.listBus);\n        let listSeatCsv = Papa.unparse(this.state.lisSeat);\n        FileSaver.saveAs(new Blob([lisBusCsv], {\n          type: 'application/octet-stream'\n        }), 'busdb.csv');\n        FileSaver.saveAs(new Blob([lisAutoMarkerCsv], {\n          type: 'application/octet-stream'\n        }), 'automarkerdb.csv');\n        FileSaver.saveAs(new Blob([listSeatCsv], {\n          type: 'application/octet-stream'\n        }), 'seatdb.csv');\n      });\n    };\n\n    this.handleOnDrop = async (file, rejectedFiles) => {\n      let contentString = await readText(file[0]);\n      let contentJson = Papa.parse(contentString);\n      let link = 'http://localhost:8000/importDatabase';\n      console.log(contentJson.data[0][0]);\n      axios.post(link, {\n        fileName: file[0].name,\n        contentJson: contentJson\n      }).then(result => {\n        console.log(result);\n      });\n    };\n\n    this.state = {\n      lisAutoMarker: [],\n      listBus: [],\n      lisSeat: []\n    };\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, \"Backup Database\"), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"button\",\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-sm-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }), React.createElement(Dropzone, {\n      className: \"col-sm-2\",\n      onDrop: this.handleOnDrop,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, ({\n      getRootProps,\n      getInputProps\n    }) => React.createElement(\"section\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, React.createElement(\"div\", Object.assign({}, getRootProps(), {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }), React.createElement(\"input\", Object.assign({}, getInputProps(), {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      className: \"btn btn-success\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, \"Import Database\")))), React.createElement(\"div\", {\n      className: \"col-sm-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"btn btn-success col-sm-2\",\n      onClick: this.exPort,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, \" Export Database \"), React.createElement(\"div\", {\n      className: \"col-sm-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default BackupDatabase;","map":{"version":3,"sources":["/home/quoctai/Tai/LSH (copy)/Client/src/component/backupDatabase.js"],"names":["React","Component","Dropzone","axios","Papa","require","FileSaver","readText","file","Promise","resolve","reject","reader","FileReader","readAsText","onload","result","onerror","BackupDatabase","constructor","props","exPort","link","post","then","setState","lisAutoMarker","data","listAutoMarker","lisSeat","listSeat","listBus","lisAutoMarkerCsv","unparse","state","lisBusCsv","listSeatCsv","saveAs","Blob","type","handleOnDrop","rejectedFiles","contentString","contentJson","parse","console","log","fileName","name","render","getRootProps","getInputProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport Dropzone from 'react-dropzone'\nimport axios from 'axios'\nimport './backupDatabase.css'\nconst Papa = require('papaparse')\nvar FileSaver = require('file-saver')\n\nconst readText = file =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsText(file)\n\n    reader.onload = () => resolve(reader.result)\n    reader.onerror = reject\n  })\n\nclass BackupDatabase extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      lisAutoMarker: [],\n      listBus: [],\n      lisSeat: []\n    }\n  }\n\n  exPort = () => {\n    let link = 'http://localhost:8000/getAllDatabase'\n    axios.post(link).then(result => {\n      this.setState({ lisAutoMarker: result.data.listAutoMarker })\n      this.setState({ lisSeat: result.data.listSeat })\n      this.setState({ listBus: result.data.listBus })\n      let lisAutoMarkerCsv = Papa.unparse(this.state.lisAutoMarker)\n      let lisBusCsv = Papa.unparse(this.state.listBus)\n      let listSeatCsv = Papa.unparse(this.state.lisSeat)\n      FileSaver.saveAs(new Blob([lisBusCsv], { type: 'application/octet-stream' }), 'busdb.csv')\n      FileSaver.saveAs(new Blob([lisAutoMarkerCsv], { type: 'application/octet-stream' }), 'automarkerdb.csv')\n      FileSaver.saveAs(new Blob([listSeatCsv], { type: 'application/octet-stream' }), 'seatdb.csv')\n    })\n  }\n\n\n  handleOnDrop = async (file, rejectedFiles) => {\n    let contentString = await readText(file[0])\n    let contentJson = Papa.parse(contentString)\n    let link = 'http://localhost:8000/importDatabase'\n    console.log(contentJson.data[0][0])\n    axios.post(link,{fileName:file[0].name, contentJson: contentJson })\n      .then(result => {\n        console.log(result)\n      })\n  }\n  render() {\n    return (\n      <div className='container'>\n        <h1>Backup Database</h1>\n        <hr />\n        <div>\n          <div className='button' className='row'>\n            <div className='col-sm-4'></div>\n            <Dropzone className = 'col-sm-2' onDrop={this.handleOnDrop}>\n              {({ getRootProps, getInputProps }) => (\n                <section>\n                  <div {...getRootProps()}>\n                    <input {...getInputProps()} />\n                    <button className = 'btn btn-success'>Import Database</button>\n                  </div>\n                </section>\n              )}\n            </Dropzone>\n\n            <div className='col-sm-1'></div>\n            <button className='btn btn-success col-sm-2' onClick={this.exPort}> Export Database </button>\n            <div className='col-sm-3'></div>\n          </div>\n\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default BackupDatabase"]},"metadata":{},"sourceType":"module"}